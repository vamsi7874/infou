{"version":3,"file":"deviceId.js","sources":["../../../../../admin/src/utils/deviceId.ts"],"sourcesContent":["const fallbackUUIDv4 = (): string => {\n  const bytes = crypto.getRandomValues(new Uint8Array(16));\n\n  bytes[6] = (bytes[6] & 0x0f) | 0x40;\n  bytes[8] = (bytes[8] & 0x3f) | 0x80;\n\n  const hex = [...bytes].map((b) => b.toString(16).padStart(2, '0'));\n  return [\n    hex.slice(0, 4).join(''),\n    hex.slice(4, 6).join(''),\n    hex.slice(6, 8).join(''),\n    hex.slice(8, 10).join(''),\n    hex.slice(10, 16).join(''),\n  ].join('-');\n};\n\n/**\n * Returns a stable device identifier for session-based authentication flows.\n * Uses localStorage to persist a UUID between sessions on the same browser.\n */\nexport const getOrCreateDeviceId = (): string => {\n  const storageKey = 'strapi.admin.deviceId';\n\n  const existing = window.localStorage.getItem(storageKey);\n  if (existing) {\n    return existing;\n  }\n\n  // Use randomUUID in secure contexts, otherwise polyfill\n  const generated =\n    typeof crypto?.randomUUID === 'function' ? crypto.randomUUID() : fallbackUUIDv4();\n\n  try {\n    window.localStorage.setItem(storageKey, generated);\n  } catch {\n    // no-op\n  }\n\n  return generated;\n};\n"],"names":["fallbackUUIDv4","bytes","crypto","getRandomValues","Uint8Array","hex","map","b","toString","padStart","slice","join","getOrCreateDeviceId","storageKey","existing","window","localStorage","getItem","generated","randomUUID","setItem"],"mappings":";;AAAA,MAAMA,cAAiB,GAAA,IAAA;AACrB,IAAA,MAAMC,KAAQC,GAAAA,MAAAA,CAAOC,eAAe,CAAC,IAAIC,UAAW,CAAA,EAAA,CAAA,CAAA;IAEpDH,KAAK,CAAC,EAAE,GAAIA,KAAK,CAAC,CAAA,CAAE,GAAG,IAAQ,GAAA,IAAA;IAC/BA,KAAK,CAAC,EAAE,GAAIA,KAAK,CAAC,CAAA,CAAE,GAAG,IAAQ,GAAA,IAAA;AAE/B,IAAA,MAAMI,GAAM,GAAA;AAAIJ,QAAAA,GAAAA;KAAM,CAACK,GAAG,CAAC,CAACC,CAAMA,GAAAA,CAAAA,CAAEC,QAAQ,CAAC,EAAA,CAAA,CAAIC,QAAQ,CAAC,CAAG,EAAA,GAAA,CAAA,CAAA;IAC7D,OAAO;AACLJ,QAAAA,GAAAA,CAAIK,KAAK,CAAC,CAAG,EAAA,CAAA,CAAA,CAAGC,IAAI,CAAC,EAAA,CAAA;AACrBN,QAAAA,GAAAA,CAAIK,KAAK,CAAC,CAAG,EAAA,CAAA,CAAA,CAAGC,IAAI,CAAC,EAAA,CAAA;AACrBN,QAAAA,GAAAA,CAAIK,KAAK,CAAC,CAAG,EAAA,CAAA,CAAA,CAAGC,IAAI,CAAC,EAAA,CAAA;AACrBN,QAAAA,GAAAA,CAAIK,KAAK,CAAC,CAAG,EAAA,EAAA,CAAA,CAAIC,IAAI,CAAC,EAAA,CAAA;AACtBN,QAAAA,GAAAA,CAAIK,KAAK,CAAC,EAAI,EAAA,EAAA,CAAA,CAAIC,IAAI,CAAC,EAAA;AACxB,KAAA,CAACA,IAAI,CAAC,GAAA,CAAA;AACT,CAAA;AAEA;;;UAIaC,mBAAsB,GAAA,IAAA;AACjC,IAAA,MAAMC,UAAa,GAAA,uBAAA;AAEnB,IAAA,MAAMC,QAAWC,GAAAA,MAAAA,CAAOC,YAAY,CAACC,OAAO,CAACJ,UAAAA,CAAAA;AAC7C,IAAA,IAAIC,QAAU,EAAA;QACZ,OAAOA,QAAAA;AACT;;AAGA,IAAA,MAAMI,YACJ,OAAOhB,MAAAA,EAAQiB,eAAe,UAAajB,GAAAA,MAAAA,CAAOiB,UAAU,EAAKnB,GAAAA,cAAAA,EAAAA;IAEnE,IAAI;AACFe,QAAAA,MAAAA,CAAOC,YAAY,CAACI,OAAO,CAACP,UAAYK,EAAAA,SAAAA,CAAAA;AAC1C,KAAA,CAAE,OAAM;;AAER;IAEA,OAAOA,SAAAA;AACT;;;;"}